╔════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                    LEARNERAI DATABASE ERD                                              ║
║                                    Entity Relationship Diagram                                         ║
╚════════════════════════════════════════════════════════════════════════════════════════════════════════╝


┌─────────────────────────────────────────────────┐
│                    WORKERS                      │
├─────────────────────────────────────────────────┤
│ PK   id                    UUID                 │
│      name                  VARCHAR(100)         │
│ UK   email                 VARCHAR(255)         │
│      department            VARCHAR(50)          │
│      position              VARCHAR(100)         │
│      status                VARCHAR(20)          │
│      overall_progress      INTEGER (0-100)      │
│      completed_courses     INTEGER              │
│      last_assessment_date  TIMESTAMP            │
│      created_at            TIMESTAMP            │
│      updated_at            TIMESTAMP            │
└─────────────────────────────────────────────────┘
                      │
                      │ 1
                      │
          ┌───────────┴───────────┬─────────────────┬─────────────────┬──────────────┐
          │                       │                 │                 │              │
          │ M                     │ M               │ M               │ M            │ M
          │                       │                 │                 │              │
    ┌─────▼───────┐      ┌───────▼────┐    ┌─────▼────────┐   ┌──────▼────────┐   ┌────────▼─────────┐
    │LEARNING     │      │ SKILL     │    │ ASSESSMENTS  │   │WORKER        │   │ AI_RECOMM       │
    │PATHS        │      │ GAPS       │    │              │   │PROGRESS      │   │_LOG            │
    ├─────────────┤      ├───────────┤    ├──────────────┤   ├──────────────┤   ├─────────────────┤
    │ PK id       │      │ PK id     │    │ PK id        │   │ PK id        │   │ PK id           │
    │    title    │      │    skill_ │    │    score     │   │    progress   │   │    action       │
    │    descr.   │      │    name   │    │    passed    │   │    completed_ │   │    data (JSONB) │
    │    diff.    │      │    status │    │    attempt_  │   │    courses    │   │    timestamp    │
    │    status   │      │    prior. │    │    number    │   │              │   │                 │
    │    hours    │      │    level  │    │    answers   │   │ FK worker_id │   │ FK worker_id    │
    │ FK worker_id│      │    conf.  │    │    time_spent│   │ FK worker_id  │   │ FK lp_id        │
    │    completed│      │ FK worker │    │ FK worker_id │   │ FK worker_id  │   │ FK course_id    │
    │    at       │      │_id        │    │ FK course_id │   │              │   │ FK skill_id     │
    │    final_   │      │           │    │ FK lp_id     │   │              │   │                 │
    │    score    │      │           │    │              │   │              │   │                 │
    └─────────────┘      └───────────┘    └──────────────┘   └──────────────┘   └─────────────────┘
          │
          │ 1
          │
          │                     ┌─────────────┐
          │                     │   MANY      │
          ├─────────────────────┤  -TO- MANY  ├─────────┐
          │ M                   │             │         │
          │                     └─────────────┘         │ M
          │                             │               │
                                          │
          │                     ┌───────▼──────────────▼─────┐
          │                     │  LEARNING_PATH_COURSES      │
          │                     ├─────────────────────────────┤
          │                     │ PK  id                     │
          │                     │ FK  learning_path_id        │
          │                     │ FK  course_id               │
          │                     │     order_index             │
          │                     │     created_at              │
          │                     │ UNIQUE(path_id, course_id) │
          │                     └─────────────────────────────┘
          │                                     │
          │                                     │ M
          │                                     │
┌─────────▼─────────────────────────────────────▼─────────┐
│                       COURSES                           │
├─────────────────────────────────────────────────────────┤
│ PK   id                  UUID                           │
│      title               VARCHAR(200)                   │
│      description         TEXT                           │
│      duration            VARCHAR(50)                     │
│      difficulty          VARCHAR(20)                     │
│      content             TEXT                           │
│      learning_objectives TEXT[]                         │
│      expanded_materials  JSONB                          │
│      created_at          TIMESTAMP                      │
│      updated_at          TIMESTAMP                      │
└─────────────────────────────────────────────────────────┘


════════════════════════════════════════════════════════════════════════════════════════════════════════

                            RELATIONSHIP SUMMARY

┌────────────────────────────────────────────────────────────────────────────────┐
│ One-to-Many Relationships                                                      │
├────────────────────────────────────────────────────────────────────────────────┤
│ • WORKERS → LEARNING_PATHS        (1 to many, via worker_id)                  │
│ • WORKERS → SKILL_GAPS            (1 to many, via worker_id)                  │
│ • WORKERS → ASSESSMENTS           (1 to many, via worker_id)                  │
│ • WORKERS → WORKER_PROGRESS       (1 to many, via worker_id)                  │
│ • WORKERS → AI_RECOMMENDATIONS_LOG (1 to many, via worker_id)                 │
│ • LEARNING_PATHS → LEARNING_PATH_COURSES (1 to many, via learning_path_id)     │
│ • LEARNING_PATHS → ASSESSMENTS    (1 to many, via learning_path_id)           │
│ • LEARNING_PATHS → AI_RECOMMENDATIONS_LOG (1 to many, via learning_path_id)    │
│ • COURSES → LEARNING_PATH_COURSES (1 to many, via course_id)                  │
│ • COURSES → ASSESSMENTS           (1 to many, via course_id)                   │
│ • COURSES → AI_RECOMMENDATIONS_LOG (1 to many, via course_id)                  │
│ • SKILL_GAPS → AI_RECOMMENDATIONS_LOG (1 to many, via skill_gap_id)          │
└────────────────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────────┐
│ Many-to-Many Relationships                                                     │
├────────────────────────────────────────────────────────────────────────────────┤
│ • LEARNING_PATHS ⟷ COURSES (via LEARNING_PATH_COURSES junction table)        │
│   - Junction table maintains course ordering via order_index field           │
│   - Unique constraint prevents duplicate course assignments                    │
└────────────────────────────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════════════════════════════════════════════════

                              KEY ATTRIBUTES

┌────────────────────────────────────────────────────────────────────────────────┐
│ Indexes for Performance                                                        │
├────────────────────────────────────────────────────────────────────────────────┤
│ • idx_workers_department       on workers(department)                          │
│ • idx_workers_status           on workers(status)                             │
│ • idx_learning_paths_worker_id on learning_paths(worker_id)                  │
│ • idx_learning_paths_status   on learning_paths(status)                      │
│ • idx_skill_gaps_worker_id     on skill_gaps(worker_id)                       │
│ • idx_skill_gaps_status        on skill_gaps(status)                           │
│ • idx_assessments_worker_id    on assessments(worker_id)                      │
│ • idx_assessments_course_id    on assessments(course_id)                       │
│ • idx_ai_log_worker_id         on ai_recommendations_log(worker_id)           │
│ • idx_ai_log_timestamp          on ai_recommendations_log(timestamp)           │
└────────────────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────────┐
│ Data Integrity Features                                                        │
├────────────────────────────────────────────────────────────────────────────────┤
│ • ALL foreign keys use ON DELETE CASCADE                                      │
│ • Check constraints on: status, priority, difficulty, scores, progress       │
│ • Unique constraints: workers.email, (learning_path_id, course_id)           │
│ • Automatic timestamp updates via PostgreSQL triggers                          │
│ • JSONB fields for flexible AI-generated content                              │
└────────────────────────────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════════════════════════════════════════════════

                              BUSINESS RULES

┌────────────────────────────────────────────────────────────────────────────────┐
│ Status Enumerations                                                            │
├────────────────────────────────────────────────────────────────────────────────┤
│ WORKERS.status:            'active' | 'inactive' | 'pending'                 │
│ LEARNING_PATHS.status:     'draft' | 'active' | 'completed' | 'archived'      │
│ LEARNING_PATHS.difficulty: 'beginner' | 'intermediate' | 'advanced'           │
│ SKILL_GAPS.priority:       'low' | 'medium' | 'high'                         │
│ SKILL_GAPS.status:         'pending' | 'in-progress' | 'completed' | 'failed'│
│ SKILL_GAPS.gap_level:      'beginner' | 'intermediate' | 'advanced'           │
│ COURSES.difficulty:         'beginner' | 'intermediate' | 'advanced'         │
└────────────────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────────┐
│ Value Range Constraints                                                        │
├────────────────────────────────────────────────────────────────────────────────┤
│ • overall_progress:    0 to 100                                               │
│ • score:               0 to 100                                               │
│ • confidence:          0.00 to 1.00                                           │
│ • attempt_number:      >= 1                                                    │
│ • progress:            0 to 100                                               │
└────────────────────────────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════════════════════════════════════════════════
